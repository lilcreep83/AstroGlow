/**
 * Redshift Distance Calculator (Hubble's Law - Simplified)
 *
 * This module calculates the approximate distance to a galaxy based on its redshift (z)
 * using the simplified linear form of Hubble's Law: d = (c * z) / H0.
 *
 * NOTE: This linear approximation is only accurate for low redshifts (z << 1).
 * For z > 0.3, a more complex cosmological model is required.
 */

// Define the speed of light in km/s (since H0 is in km/s/Mpc)
const C_SPEED_OF_LIGHT = 300000; // 3.00 x 10^5 km/s

/**
 * Converts a distance in Megaparsecs (Mpc) to Light Years (ly).
 * 1 Megaparsec â‰ˆ 3.26 million light-years
 * @param {number} mpc - Distance in Megaparsecs.
 * @returns {number} Distance in Light Years.
 */
function mpcToLightYears(mpc) {
    // 3.26e6 is 3,260,000
    return mpc * 3.26e6;
}

/**
 * Calculates the galaxy distance using the simplified Hubble's Law.
 * d = (c * z) / H0
 *
 * @param {number} z - The measured redshift.
 * @param {number} H0 - The Hubble Constant in km/s/Mpc (e.g., 70).
 * @returns {object} An object containing the distance in Mpc and Light Years, or an error message.
 */
function calculateGalaxyDistance(z, H0) {
    // --- Input Validation ---
    if (typeof z !== 'number' || isNaN(z) || z < 0) {
        return { error: "Invalid redshift (z). Must be a non-negative number." };
    }
    if (typeof H0 !== 'number' || isNaN(H0) || H0 <= 0) {
        return { error: "Invalid Hubble Constant (H0). Must be a positive number." };
    }

    // --- Calculation ---
    // 1. Calculate Recessional Velocity (v) using v = c * z
    // 2. Calculate Distance (d) using d = v / H0, so d = (c * z) / H0
    const distanceMpc = (C_SPEED_OF_LIGHT * z) / H0;
    const distanceLy = mpcToLightYears(distanceMpc);

    let warning = null;
    if (z > 0.3) {
        warning = "Warning: For z > 0.3, this simple linear formula is inaccurate. A full cosmological model is needed to account for the changing expansion rate of the Universe over time.";
    }

    return {
        redshift: z,
        hubbleConstant: H0,
        distanceMpc: distanceMpc,
        distanceLy: distanceLy,
        warning: warning
    };
}

// --- Example Usage ---
// Example: A galaxy with a redshift of 0.05, using H0 = 70 km/s/Mpc
const exampleRedshift = 0.05;
const exampleHubbleConstant = 70;

const result = calculateGalaxyDistance(exampleRedshift, exampleHubbleConstant);

console.log("--- Redshift Distance Calculation Example ---");
if (result.error) {
    console.error("Error:", result.error);
} else {
    console.log(`Input Redshift (z): ${result.redshift}`);
    console.log(`Input Hubble Constant (H0): ${result.hubbleConstant} km/s/Mpc`);
    console.log(`Calculated Distance (Mpc): ${result.distanceMpc.toFixed(3)} Mpc`);
    console.log(`Calculated Distance (Light Years): ${result.distanceLy.toFixed(0)} ly`);
    if (result.warning) {
        console.warn(result.warning);
    }
}